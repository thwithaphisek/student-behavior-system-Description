<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏á‡∏≤‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</title>
    <style>
        /* CSS ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÉ‡∏´‡∏°‡πà ‡πÄ‡∏ô‡πâ‡∏ô‡πÇ‡∏ó‡∏ô‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß Earthy/Premium */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏ó‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° (Earthy Green) */
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #2c5f59 0%, #007769 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }

        .header h1 {
            text-align: center;
            color: #2c5f59;
            margin-bottom: 20px;
            font-size: 2.5rem;
            /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ Gradient ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° */
            background: linear-gradient(45deg, #007769, #2c5f59);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .nav-btn {
            /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° */
            background: linear-gradient(45deg, #007769, #2c5f59);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 119, 105, 0.4);
            position: relative;
            overflow: hidden;
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 119, 105, 0.6);
        }

        .nav-btn.active {
             /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ Active State ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏≠‡πà‡∏≠‡∏ô‡∏•‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
            background: linear-gradient(45deg, #2c5f59, #007769);
            transform: translateY(-2px);
        }

        .nav-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .nav-btn:hover::before {
            left: 100%;
        }

        .page {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            border: 1px solid rgba(255, 255, 255, 0.18);
            animation: fadeIn 0.5s ease-in;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .page h2 {
            margin-bottom: 25px;
            color: #2c5f59;
            font-size: 1.8rem;
            /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡πÄ‡∏™‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° */
            border-bottom: 3px solid #007769;
            padding-bottom: 10px;
        }
        
        /* New: Sub-page style for Document/Lending Tracking */
        .sub-page {
            display: none;
            padding: 20px;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            margin-top: 15px;
            background-color: #f8f9fa;
        }
        .sub-page.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }


        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c5f59;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
            background-color: #fff;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ Focus Border ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° */
            border-color: #007769; 
            box-shadow: 0 0 0 3px rgba(0, 119, 105, 0.1);
            transform: translateY(-1px);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
            font-family: inherit;
        }

        .btn {
            /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏õ‡∏∏‡πà‡∏° Submit ‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° */
            background: linear-gradient(45deg, #007769, #2c5f59);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 119, 105, 0.4);
            position: relative;
            overflow: hidden;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 119, 105, 0.6);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-success {
            background: linear-gradient(45deg, #007769, #004d41);
        }
        
        .btn-danger {
            background: linear-gradient(45deg, #dc3545, #fd7e14);
        }

        .btn-warning {
            background: linear-gradient(45deg, #ffdb58, #ffc107); /* ‡πÉ‡∏ä‡πâ‡∏™‡∏µ‡∏ó‡∏≠‡∏á Accent */
        }

        .btn-info {
            background: linear-gradient(45deg, #2196f3, #00bcd4); /* ‡∏Ñ‡∏á‡∏™‡∏µ‡∏ü‡πâ‡∏≤ Info ‡πÑ‡∏ß‡πâ */
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: 500;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .alert-success {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .alert-danger {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }

        .alert-info {
            background-color: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }

        .alert-warning {
            background-color: #fff3cd;
            border: 1px solid #ffdb58;
            color: #856404;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .table th,
        .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }

        .table th {
            /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° */
            background: linear-gradient(45deg, #2c5f59, #007769);
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .table tr:hover {
            background-color: #f8f9fa;
            transform: scale(1.01);
            transition: all 0.2s ease;
        }

        .table tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        .login-form {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
        }

        .status-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 10px 0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏Ç‡∏≠‡∏ö‡∏ã‡πâ‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° */
            border-left: 4px solid #007769;
            transition: all 0.3s ease;
        }

        .status-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .action-buttons button {
            padding: 8px 16px;
            font-size: 14px;
            border-radius: 20px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            max-width: 300px;
            z-index: 9999;
            animation: slideInRight 0.3s ease-out;
        }

        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(100%); }
            to { opacity: 1; transform: translateX(0); }
        }

        .stats-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin: 10px 0;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            text-align: center;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .stats-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
        }

        .stats-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏Ç‡∏≠‡∏ö‡∏ö‡∏ô Stats Card ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° */
            background: linear-gradient(45deg, #007769, #2c5f59);
        }

        .stats-number {
            font-size: 2.5rem;
            font-weight: bold;
            /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç Stats ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° */
            color: #007769;
            margin: 10px 0;
        }

        .stats-label {
            font-size: 0.9rem;
            color: #6c757d;
            font-weight: 500;
        }

        .stats-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .search-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .search-container input {
            flex: 1;
        }

        .camp-status-select {
            padding: 8px 16px;
            border-radius: 20px;
            border: 2px solid #e9ecef;
            font-size: 14px;
            background-color: white;
            margin-right: 10px;
        }

        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-align: center;
            display: inline-block;
        }

        /* Camp Status */
        .status-‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢ { background-color: #dc3545; color: white; }
        .status-‡∏à‡∏¥‡∏ï‡∏≠‡∏≤‡∏™‡∏≤ { background-color: #007769; color: white; } /* ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° */
        .status-‡∏≠‡∏∑‡πà‡∏ô‡πÜ { background-color: #6c757d; color: white; }
        .follow-‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß { background-color: #007769; color: white; } /* ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° */
        .follow-‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ { background-color: #ffdb58; color: #333; } /* ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≠‡∏á */
        .follow-‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ú‡∏• { background-color: #2196f3; color: white; } /* ‡∏Ñ‡∏á‡∏™‡∏µ‡∏ü‡πâ‡∏≤ */
        .follow-‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß { background-color: #2196f3; color: white; } /* ‡∏Ñ‡∏á‡∏™‡∏µ‡∏ü‡πâ‡∏≤ */
        .follow-‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ { background-color: #6c757d; color: white; }
        
        /* Document Status */
        .status-‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ { background-color: #ffdb58; color: #333; } /* ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≠‡∏á */
        .status-‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß { background-color: #007769; color: white; } /* ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° */
        .status-‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏•‡πâ‡∏ß { background-color: #2196f3; color: white; }
        .status-‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à { background-color: #dc3545; color: white; }

        /* Lending Status */
        .status-‡∏¢‡∏∑‡∏°‡∏≠‡∏¢‡∏π‡πà { background-color: #dc3545; color: white; }
        .status-‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß { background-color: #007769; color: white; } /* ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° */


        .grade-filter-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .grade-filter-btn {
            padding: 8px 16px;
            border-radius: 20px;
            /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° */
            border: 2px solid #007769;
            background-color: white;
            color: #007769;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .grade-filter-btn:hover {
            background-color: #007769;
            color: white;
            transform: translateY(-2px);
        }

        .grade-filter-btn.active {
            background-color: #007769;
            color: white;
            box-shadow: 0 4px 15px rgba(0, 119, 105, 0.4);
        }
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .nav {
                flex-direction: column;
            }
            
            .nav-btn {
                width: 100%;
            }
            
            .table {
                font-size: 14px;
            }
            
            .action-buttons {
                flex-direction: column;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .search-container {
                flex-direction: column;
            }
        }

        .fade-out {
            animation: fadeOut 0.3s ease-out forwards;
        }

        @keyframes fadeOut {
            to { opacity: 0; transform: translateX(100%); }
        }

        /* New: Card Layout CSS (‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô) */
        .home-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            padding: 20px;
        }

        .home-card {
            /* ‡πÉ‡∏ä‡πâ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏≠‡πà‡∏≠‡∏ô/‡∏´‡∏¥‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á Card */
            background: rgba(195, 232, 228, 0.95); 
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.2);
            border: 1px solid rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            min-height: 120px; /* ‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏•‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .home-card:hover {
            transform: translateY(-3px);
             /* ‡πÄ‡∏ô‡πâ‡∏ô Border ‡∏î‡πâ‡∏ß‡∏¢‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° */
            border: 2px solid #007769; 
            box-shadow: 0 12px 40px rgba(0, 119, 105, 0.3);
        }

        .card-icon {
            /* ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å */
            display: none;
            visibility: hidden;
            font-size: 3.5rem;
            margin-bottom: 0px; 
        }

        .card-title {
            font-size: 1.6rem; /* ‡πÄ‡∏ô‡πâ‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÉ‡∏´‡πâ‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô */
            font-weight: 800;
            color: #2c5f59; /* ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÉ‡∏ä‡πâ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° */
            margin-bottom: 5px;
        }

        .card-description {
            font-size: 1rem;
            color: #555;
        }

        /* Hide the original nav bar */
        .header .nav { display: none; }
        
        /* New: Back Button Style */
        .back-button {
            /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° */
            background: #2c5f59;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-bottom: 20px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .back-button:hover {
            background: #1e3f3d;
            transform: translateY(-1px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèõÔ∏è ‡∏á‡∏≤‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h1>
            </div>
        
        <div id="home" class="page active">
            <h2>‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å: ‡∏£‡∏∞‡∏ö‡∏ö‡∏á‡∏≤‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
            <div class="home-grid">
                
                <div class="home-card" onclick="showPage('register', event)">
                    <div class="card-icon">üèÖ</div>
                    <div class="card-title">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏µ</div>
                    <div class="card-description">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏£‡∏π/‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏µ‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
                </div>

                <div class="home-card" onclick="showPage('status', event)">
                    <div class="card-icon">üö¶</div>
                    <div class="card-title">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°</div>
                    <div class="card-description">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô/‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</div>
                </div>

                <div class="home-card" onclick="showPage('documentTracking', event)">
                    <div class="card-icon">üñãÔ∏è</div>
                    <div class="card-title">‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
                    <div class="card-description">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ï‡πà‡∏≤‡∏á‡πÜ</div>
                </div>

                <div class="home-card" onclick="showPage('lendingTracking', event)">
                    <div class="card-icon">üîë</div>
                    <div class="card-title">‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°‡∏Ç‡∏≠‡∏á</div>
                    <div class="card-description">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∑‡∏ô‡∏™‡∏¥‡πà‡∏á‡∏Ç‡∏≠‡∏á/‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</div>
                </div>

                <div class="home-card" onclick="showPage('admin', event)">
                    <div class="card-icon">üìä</div>
                    <div class="card-title">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</div>
                    <div class="card-description">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡∏∞‡∏≠‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</div>
                </div>
            </div>
        </div>

        <div id="register" class="page">
            <h2>üìù ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏µ</h2>
            <button class="back-button" onclick="showPage('home', event)">
                ‚¨ÖÔ∏è ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
            </button>
            <form id="registerForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="studentId">‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô *</label>
                        <input type="text" id="studentId" required placeholder="‡πÄ‡∏ä‡πà‡∏ô S001234" maxlength="20">
                    </div>
                    <div class="form-group">
                        <label for="studentNo">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà *</label>
                        <input type="number" id="studentNo" required placeholder="‡πÄ‡∏ä‡πà‡∏ô 15" min="1" max="50">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="fullName">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• *</label>
                    <input type="text" id="fullName" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ" maxlength="100">
                </div>
                
                <div class="form-group">
                    <label for="classroom">‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô *</label>
                    <select id="classroom" required>
                        <option value="">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
                        <optgroup label="‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1">
                            <option value="1/1">1/1</option>
                            <option value="1/2">1/2</option>
                            <option value="1/3">1/3</option>
                            <option value="1/4">1/4</option>
                            <option value="1/5">1/5</option>
                            <option value="1/6">1/6</option>
                            <option value="1/7">1/7</option>
                            <option value="1/8">1/8</option>
                            <option value="1/9">1/9</option>
                            <option value="1/10">1/10</option>
                            <option value="1/11">1/11</option>
                            <option value="1/12">1/12</option>
                        </optgroup>
                        <optgroup label="‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 2">
                            <option value="2/1">2/1</option>
                            <option value="2/2">2/2</option>
                            <option value="2/3">2/3</option>
                            <option value="2/4">2/4</option>
                            <option value="2/5">2/5</option>
                            <option value="2/6">2/6</option>
                            <option value="2/7">2/7</option>
                            <option value="2/8">2/8</option>
                            <option value="2/9">2/9</option>
                            <option value="2/10">2/10</option>
                        </optgroup>
                        <optgroup label="‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 3">
                            <option value="3/1">3/1</option>
                            <option value="3/2">3/2</option>
                            <option value="3/3">3/3</option>
                            <option value="3/4">3/4</option>
                            <option value="3/5">3/5</option>
                            <option value="3/6">3/6</option>
                            <option value="3/7">3/7</option>
                            <option value="3/8">3/8</option>
                            <option value="3/9">3/9</option>
                            <option value="3/10">3/10</option>
                        </optgroup>
                        <optgroup label="‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 4">
                            <option value="4/1">4/1</option>
                            <option value="4/2">4/2</option>
                            <option value="4/3">4/3</option>
                            <option value="4/4">4/4</option>
                            <option value="4/5">4/5</option>
                            <option value="4/6">4/6</option>
                            <option value="4/7">4/7</option>
                            <option value="4/8">4/8</option>
                            <option value="4/9">4/9</option>
                            <option value="4/10">4/10</option>
                            <option value="4/11">4/11</option>
                            <option value="4/12">4/12</option>
                        </optgroup>
                        <optgroup label="‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 5">
                            <option value="5/1">5/1</option>
                            <option value="5/2">5/2</option>
                            <option value="5/3">5/3</option>
                            <option value="5/4">5/4</option>
                            <option value="5/5">5/5</option>
                            <option value="5/6">5/6</option>
                            <option value="5/7">5/7</option>
                            <option value="5/8">5/8</option>
                            <option value="5/9">5/9</option>
                            <option value="5/10">5/10</option>
                            <option value="5/11">5/11</option>
                            <option value="5/12">5/12</option>
                        </optgroup>
                        <optgroup label="‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 6">
                            <option value="6/1">6/1</option>
                            <option value="6/2">6/2</option>
                            <option value="6/3">6/3</option>
                            <option value="6/4">6/4</option>
                            <option value="6/5">6/5</option>
                            <option value="6/6">6/6</option>
                            <option value="6/7">6/7</option>
                            <option value="6/8">6/8</option>
                            <option value="6/9">6/9</option>
                            <option value="6/10">6/10</option>
                            <option value="6/11">6/11</option>
                            <option value="6/12">6/12</option>
                        </optgroup>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="behavior">‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏µ *</label>
                    <textarea id="behavior" required placeholder="‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÑ‡∏î‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏≠‡∏Å ‡πÄ‡∏ä‡πà‡∏ô ‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô, ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô, ‡∏°‡∏µ‡∏™‡∏±‡∏°‡∏°‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏∞, ‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏ñ‡∏ß‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤, ‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô" maxlength="500"></textarea>
                    <small style="color: #6c757d;">‡πÄ‡∏´‡∏•‡∏∑‡∏≠ <span id="behaviorCount">500</span> ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£</small>
                </div>
                
                <div class="form-group">
                    <label for="score">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô *</label>
                    <select id="score" required>
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</option>
                        <option value="1">1 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô - ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏î‡∏µ‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢</option>
                        <option value="2">2 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô - ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏î‡∏µ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</option>
                        <option value="3">3 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô - ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏î‡∏µ‡∏°‡∏≤‡∏Å</option>
                        <option value="4">4 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô - ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏î‡∏µ‡∏°‡∏≤‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©</option>
                        <option value="5">5 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô - ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏î‡∏µ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ö‡∏ö‡∏≠‡∏¢‡πà‡∏≤‡∏á</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="teacherName">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏π / ‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£ *</label>
                    <input type="text" id="teacherName" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡∏™‡∏°‡∏´‡∏Å‡∏¥‡∏á ‡πÉ‡∏à‡∏î‡∏µ" maxlength="100">
                </div>
                
                <button type="submit" class="btn">
                    <span id="submitLoading" style="display: none;" class="loading"></span>
                    <span id="submitText">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
                </button>
            </form>
            
            <div id="registerMessage"></div>
        </div>

        <div id="status" class="page">
            <h2>üö¶ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°</h2>
            <button class="back-button" onclick="showPage('home', event)">
                ‚¨ÖÔ∏è ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
            </button>
            <div class="search-container">
                <input type="text" id="searchStudentId" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ (‡πÄ‡∏ä‡πà‡∏ô S001234)">
                <button onclick="searchStatus()" class="btn">
                    <span id="searchLoading" style="display: none;" class="loading"></span>
                    <span id="searchText">üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</span>
                </button>
            </div>
            
            <div id="statusResults"></div>
        </div>

        <div id="documentTracking" class="page">
            <h2>üñãÔ∏è ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
            <button class="back-button" onclick="showPage('home', event)">
                ‚¨ÖÔ∏è ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
            </button>
            <div class="nav">
                <button class="nav-btn active" onclick="showDocumentSubPage('addDocument')">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà</button>
                <button class="nav-btn" onclick="showDocumentSubPage('viewDocument')">üìã ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</button>
            </div>
            <hr>

            <div id="addDocument" class="sub-page active">
                <h3>5.1 ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà (‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô Admin1234)</h3>
                <form id="addDocumentForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="docStudentId">‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô *</label>
                            <input type="text" id="docStudentId" required placeholder="‡πÄ‡∏ä‡πà‡∏ô S001234" maxlength="20">
                        </div>
                        <div class="form-group">
                            <label for="docFullName">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• *</label>
                            <input type="text" id="docFullName" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ" maxlength="100">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="docType">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ *</label>
                        <select id="docType" required>
                            <option value="">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</option>
                            <option value="‡πÉ‡∏ö‡∏•‡∏≤‡∏≠‡∏≠‡∏Å">‡πÉ‡∏ö‡∏•‡∏≤‡∏≠‡∏≠‡∏Å</option>
                            <option value="‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô</option>
                            <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="docStatus">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏´‡∏•‡∏±‡∏Å *</label>
                        <select id="docStatus" required>
                            <option value="‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                            <option value="‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß</option>
                            <option value="‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏•‡πâ‡∏ß">‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏•‡πâ‡∏ß</option>
                            <option value="‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à">‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="docSentDate">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á *</label>
                        <input type="date" id="docSentDate" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="docNote">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
                        <textarea id="docNote" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°" maxlength="500"></textarea>
                    </div>

                    <button type="submit" class="btn btn-success">
                        <span id="docSubmitLoading" style="display: none;" class="loading"></span>
                        <span id="docSubmitText">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</span>
                    </button>
                </form>
            </div>

            <div id="viewDocument" class="sub-page">
                <h3>5.2 ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
                <div id="docReportStats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;"></div>
                <div id="docFilterControls" style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                    <select id="docStatusFilter" onchange="filterDocumentData()" class="camp-status-select">
                        <option value="">üìã ‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                        <option value="‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                        <option value="‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß</option>
                        <option value="‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏•‡πâ‡∏ß">‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏•‡πâ‡∏ß</option>
                        <option value="‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à">‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</option>
                    </select>
                    <button onclick="loadDocumentData()" class="btn">‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà</button>
                </div>
                <div id="documentDataDisplay"></div>
            </div>
        </div>

        <div id="lendingTracking" class="page">
            <h2>üîë ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°‡∏Ç‡∏≠‡∏á</h2>
            <button class="back-button" onclick="showPage('home', event)">
                ‚¨ÖÔ∏è ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
            </button>
            <div class="nav">
                <button class="nav-btn active" onclick="showLendingSubPage('addLending')">‚ûï ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°‡∏Ç‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</button>
                <button class="nav-btn" onclick="showLendingSubPage('viewLending')">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°</button>
            </div>
            <hr>

            <div id="addLending" class="sub-page active">
                <h3>6.1 ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°‡∏Ç‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</h3>
                <form id="addLendingForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="lendStudentId">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß *</label>
                            <input type="text" id="lendStudentId" required placeholder="‡πÄ‡∏ä‡πà‡∏ô S001234" maxlength="20">
                        </div>
                        <div class="form-group">
                            <label for="lendClassroom">‡∏´‡πâ‡∏≠‡∏á *</label>
                            <input type="text" id="lendClassroom" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏°.4/10" maxlength="10">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="lendFullName">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏¢‡∏∑‡∏° *</label>
                        <input type="text" id="lendFullName" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ" maxlength="100">
                    </div>

                    <div class="form-group">
                        <label for="lendTel">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ *</label>
                        <input type="tel" id="lendTel" required placeholder="‡πÄ‡∏ä‡πà‡∏ô 08x-xxxxxxx" maxlength="15">
                    </div>
                    
                    <div class="form-group">
                        <label for="lendItem">‡∏™‡∏¥‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡∏° *</label>
                        <textarea id="lendItem" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏∏‡∏ç‡πÅ‡∏à‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å‡∏Ñ‡∏£‡∏π 1105, ‡πÑ‡∏°‡πÇ‡∏Ñ‡∏£‡πÇ‡∏ü‡∏ô‡πÑ‡∏£‡πâ‡∏™‡∏≤‡∏¢ #3" maxlength="300"></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="lendDate">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡∏° *</label>
                            <input type="date" id="lendDate" required>
                        </div>
                        <div class="form-group">
                            <label for="returnDate">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏∑‡∏ô (‡∏Å‡∏≥‡∏´‡∏ô‡∏î)</label>
                            <input type="date" id="returnDate">
                        </div>
                    </div>

                    <button type="submit" class="btn">
                        <span id="lendSubmitLoading" style="display: none;" class="loading"></span>
                        <span id="lendSubmitText">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°</span>
                    </button>
                </form>
            </div>

            <div id="viewLending" class="sub-page">
                <h3>6.2 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°</h3>
                <div id="lendFilterControls" style="margin-bottom: 20px;">
                    <button onclick="loadLendingData(false)" class="btn btn-warning">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏∑‡∏ô</button>
                    <button onclick="loadLendingData(true)" class="btn btn-success">‚úÖ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß</button>
                </div>
                <div id="lendReportStats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;"></div>
                <div id="lendingDataDisplay"></div>
            </div>
        </div>

        <div id="admin" class="page">
            
            <div id="loginSection">
                <h2>üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•</h2>
                <button class="back-button" onclick="showPage('home', event)" style="margin-bottom: 20px;">
                    ‚¨ÖÔ∏è ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                </button>
                <div class="login-form">
                    <div class="form-group">
                        <label for="adminPassword">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
                        <input type="password" id="adminPassword" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
                    </div>
                    <button onclick="adminLogin()" class="btn" style="width: 100%;">
                        <span id="loginLoading" style="display: none;" class="loading"></span>
                        <span id="loginText">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</span>
                    </button>
                </div>
                <div id="loginMessage"></div>
            </div>

            <div id="adminPanel" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px;">
                    <h2>üìä ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏ö‡∏ö</h2>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                         <button class="btn" style="background: #6c757d;" onclick="showPage('home', event)">
                            ‚¨ÖÔ∏è ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                        </button>
                        <button onclick="showAdminReportMenu()" class="btn btn-warning">üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°</button>
                        <button onclick="exportAllData()" class="btn btn-info">üì§ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (CSV)</button>
                        <button onclick="adminLogout()" class="btn btn-danger">üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
                    </div>
                </div>

                <div id="adminReportMenu" style="margin-bottom: 30px; display: none;">
                    <h3>üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° (‡∏™‡∏£‡∏∏‡∏õ 3 ‡∏°‡∏¥‡∏ï‡∏¥)</h3>
                    <div class="nav" style="margin-bottom: 15px;">
                        <button class="nav-btn active" onclick="showAdminReport('behaviorReport', this)">‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏µ</button>
                        <button class="nav-btn" onclick="showAdminReport('campReport', this)">‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢</button>
                        <button class="nav-btn" onclick="showAdminReport('documentReport', this)">‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</button>
                        <button class="nav-btn" onclick="showAdminReport('lendingReport', this)">‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°‡∏Ç‡∏≠‡∏á</button>
                    </div>
                    
                    <div id="behaviorReport" class="report-content active">
                        <h4>üìà ‡∏™‡∏£‡∏∏‡∏õ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏µ</h4>
                        <div id="adminStats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;"></div>
                    </div>
                    <div id="campReport" class="report-content">
                        <h4>üèïÔ∏è ‡∏™‡∏£‡∏∏‡∏õ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢</h4>
                        <div id="adminCampStats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;"></div>
                    </div>
                    <div id="documentReport" class="report-content">
                        <h4>üìÑ ‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h4>
                        <div id="adminDocStats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;"></div>
                    </div>
                    <div id="lendingReport" class="report-content">
                        <h4>üìö ‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°‡∏Ç‡∏≠‡∏á</h4>
                        <div id="adminLendStats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;"></div>
                    </div>
                    <hr>
                </div>
                
                <div id="adminDataMenu" style="margin-bottom: 30px;">
                    <h3>üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</h3>
                    <div class="nav" style="margin-bottom: 15px;">
                        <button class="nav-btn active" onclick="showAdminData('behaviorData', this)">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏µ</button>
                        <button class="nav-btn" onclick="showAdminData('campData', this)">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢</button>
                    </div>

                    <div id="behaviorData" class="data-content active">
                        <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px;">
                            <button onclick="loadAllData()" class="btn">
                                <span id="loadLoading" style="display: none;" class="loading"></span>
                                <span id="loadText">üìã ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                            </button>
                            <select id="statusFilter" onchange="filterByStatus()" class="form-control" style="padding: 8px; border-radius: 20px; border: 2px solid #e9ecef;">
                                <option value="">üìã ‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                                <option value="‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‚è≥ ‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                                <option value="‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö">üîç ‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</option>
                                <option value="‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥">‚úÖ ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</option>
                                <option value="‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥">‚ùå ‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</option>
                            </select>
                        </div>
                        <div id="adminData"></div>
                    </div>

                    <div id="campData" class="data-content">
                        <h3>üèïÔ∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢</h3>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px;">
                            <button onclick="addCampStudent()" class="btn btn-success">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢</button>
                            <button onclick="loadCampData()" class="btn">‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏¢</button>
                            <button onclick="exportCampData()" class="btn btn-info">üì§ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏¢</button>
                        </div>
                        <div id="campAdminFilters" style="display: flex; gap: 10px; align-items: center; margin-bottom: 15px; flex-wrap: wrap;">
                            <select id="campStatusFilter" onchange="filterCampData()" class="camp-status-select">
                                <option value="">üèïÔ∏è ‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                                <option value="‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢">‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢</option>
                                <option value="‡∏à‡∏¥‡∏ï‡∏≠‡∏≤‡∏™‡∏≤">‡∏à‡∏¥‡∏ï‡∏≠‡∏≤‡∏™‡∏≤</option>
                                <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                            </select>
                            <select id="campFollowFilter" onchange="filterCampData()" class="camp-status-select">
                                <option value="">üìã ‡∏ó‡∏∏‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</option>
                                <option value="‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß</option>
                                <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                                <option value="‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ú‡∏•">‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ú‡∏•</option>
                                <option value="‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß</option>
                                <option value="‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                            </select>
                        </div>
                        <div class="grade-filter-container">
                            <button class="grade-filter-btn active" onclick="filterByGrade('all')">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                            <button class="grade-filter-btn" onclick="filterByGrade('1')">‡∏°.1</button>
                            <button class="grade-filter-btn" onclick="filterByGrade('2')">‡∏°.2</button>
                            <button class="grade-filter-btn" onclick="filterByGrade('3')">‡∏°.3</button>
                            <button class="grade-filter-btn" onclick="filterByGrade('4')">‡∏°.4</button>
                            <button class="grade-filter-btn" onclick="filterByGrade('5')">‡∏°.5</button>
                            <button class="grade-filter-btn" onclick="filterByGrade('6')">‡∏°.6</button>
                        </div>
                        <div id="campDataDisplay"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="campModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; justify-content: center; align-items: center;">
        <div style="background: white; padding: 30px; border-radius: 15px; max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto;">
            <h3 style="margin-bottom: 20px; color: #2c3e50;">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢</h3>
            <form id="campForm">
                <div class="form-group">
                    <label for="campStudentId">‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô *</label>
                    <input type="text" id="campStudentId" required placeholder="‡πÄ‡∏ä‡πà‡∏ô S001234" maxlength="20">
                </div>
                
                <div class="form-group">
                    <label for="campFullName">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• *</label>
                    <input type="text" id="campFullName" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ" maxlength="100">
                </div>
                
                <div class="form-group">
                    <label for="campClassroom">‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô *</label>
                    <select id="campClassroom" required>
                        <option value="">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
                        <optgroup label="‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1">
                            <option value="‡∏°.1/1">‡∏°.1/1</option>
                            <option value="‡∏°.1/2">‡∏°.1/2</option>
                            <option value="‡∏°.1/3">‡∏°.1/3</option>
                            <option value="‡∏°.1/4">‡∏°.1/4</option>
                            <option value="‡∏°.1/5">‡∏°.1/5</option>
                            <option value="‡∏°.1/6">‡∏°.1/6</option>
                            <option value="‡∏°.1/7">‡∏°.1/7</option>
                            <option value="‡∏°.1/8">‡∏°.1/8</option>
                            <option value="‡∏°.1/9">‡∏°.1/9</option>
                            <option value="‡∏°.1/10">‡∏°.1/10</option>
                            <option value="‡∏°.1/11">‡∏°.1/11</option>
                            <option value="‡∏°.1/12">‡∏°.1/12</option>
                        </optgroup>
                        <optgroup label="‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 2">
                            <option value="‡∏°.2/1">‡∏°.2/1</option>
                            <option value="‡∏°.2/2">‡∏°.2/2</option>
                            <option value="‡∏°.2/3">‡∏°.2/3</option>
                            <option value="‡∏°.2/4">‡∏°.2/4</option>
                            <option value="‡∏°.2/5">‡∏°.2/5</option>
                            <option value="‡∏°.2/6">‡∏°.2/6</option>
                            <option value="‡∏°.2/7">‡∏°.2/7</option>
                            <option value="‡∏°.2/8">‡∏°.2/8</option>
                            <option value="‡∏°.2/9">‡∏°.2/9</option>
                            <option value="‡∏°.2/10">‡∏°.2/10</option>
                        </optgroup>
                        <optgroup label="‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 3">
                            <option value="‡∏°.3/1">‡∏°.3/1</option>
                            <option value="‡∏°.3/2">‡∏°.3/2</option>
                            <option value="‡∏°.3/3">‡∏°.3/3</option>
                            <option value="‡∏°.3/4">‡∏°.3/4</option>
                            <option value="‡∏°.3/5">‡∏°.3/5</option>
                            <option value="‡∏°.3/6">‡∏°.3/6</option>
                            <option value="‡∏°.3/7">‡∏°.3/7</option>
                            <option value="‡∏°.3/8">‡∏°.3/8</option>
                            <option value="‡∏°.3/9">‡∏°.3/9</option>
                            <option value="‡∏°.3/10">‡∏°.3/10</option>
                        </optgroup>
                        <optgroup label="‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 4">
                            <option value="‡∏°.4/1">‡∏°.4/1</option>
                            <option value="‡∏°.4/2">‡∏°.4/2</option>
                            <option value="‡∏°.4/3">‡∏°.4/3</option>
                            <option value="‡∏°.4/4">‡∏°.4/4</option>
                            <option value="‡∏°.4/5">‡∏°.4/5</option>
                            <option value="‡∏°.4/6">‡∏°.4/6</option>
                            <option value="‡∏°.4/7">‡∏°.4/7</option>
                            <option value="‡∏°.4/8">‡∏°.4/8</option>
                            <option value="‡∏°.4/9">‡∏°.4/9</option>
                            <option value="‡∏°.4/10">‡∏°.4/10</option>
                            <option value="‡∏°.4/11">‡∏°.4/11</option>
                            <option value="‡∏°.4/12">‡∏°.4/12</option>
                        </optgroup>
                        <optgroup label="‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 5">
                            <option value="‡∏°.5/1">‡∏°.5/1</option>
                            <option value="‡∏°.5/2">‡∏°.5/2</option>
                            <option value="‡∏°.5/3">‡∏°.5/3</option>
                            <option value="‡∏°.5/4">‡∏°.5/4</option>
                            <option value="‡∏°.5/5">‡∏°.5/5</option>
                            <option value="‡∏°.5/6">‡∏°.5/6</option>
                            <option value="‡∏°.5/7">‡∏°.5/7</option>
                            <option value="‡∏°.5/8">‡∏°.5/8</option>
                            <option value="‡∏°.5/9">‡∏°.5/9</option>
                            <option value="‡∏°.5/10">‡∏°.5/10</option>
                            <option value="‡∏°.5/11">‡∏°.5/11</option>
                            <option value="‡∏°.5/12">‡∏°.5/12</option>
                        </optgroup>
                        <optgroup label="‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 6">
                            <option value="‡∏°.6/1">‡∏°.6/1</option>
                            <option value="‡∏°.6/2">‡∏°.6/2</option>
                            <option value="‡∏°.6/3">‡∏°.6/3</option>
                            <option value="‡∏°.6/4">‡∏°.6/4</option>
                            <option value="‡∏°.6/5">‡∏°.6/5</option>
                            <option value="‡∏°.6/6">‡∏°.6/6</option>
                            <option value="‡∏°.6/7">‡∏°.6/7</option>
                            <option value="‡∏°.6/8">‡∏°.6/8</option>
                            <option value="‡∏°.6/9">‡∏°.6/9</option>
                            <option value="‡∏°.6/10">‡∏°.6/10</option>
                            <option value="‡∏°.6/11">‡∏°.6/11</option>
                            <option value="‡∏°.6/12">‡∏°.6/12</option>
                        </optgroup>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="campStatus">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ *</label>
                    <select id="campStatus" required>
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                        <option value="‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢">‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢</option>
                        <option value="‡∏à‡∏¥‡∏ï‡∏≠‡∏≤‡∏™‡∏≤">‡∏à‡∏¥‡∏ï‡∏≠‡∏≤‡∏™‡∏≤</option>
                        <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="campFollow">‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° *</label>
                    <select id="campFollow" required>
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</option>
                        <option value="‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                        <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                        <option value="‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ú‡∏•">‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ú‡∏•</option>
						<option value="‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß</option>	
                        <option value="‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="campNote">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
                    <textarea id="campNote" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)" maxlength="300"></textarea>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                    <button type="button" onclick="closeCampModal()" class="btn" style="background: #6c757d;">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    <button type="submit" class="btn btn-success">
                        <span id="campSubmitLoading" style="display: none;" class="loading"></span>
                        <span id="campSubmitText">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="docEditModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10001; justify-content: center; align-items: center;">
        <div style="background: white; padding: 30px; border-radius: 15px; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto;">
            <h3 style="margin-bottom: 20px; color: #2c3e50;">üîÑ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h3>
            <div id="docEditContent">
                <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
            </div>
             <div style="display: flex; justify-content: flex-end; margin-top: 20px;">
                <button type="button" onclick="closeDocEditModal()" class="btn" style="background: #6c757d;">‡∏õ‡∏¥‡∏î</button>
            </div>
        </div>
    </div>
    
    <script>
        // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î URL ‡∏Ç‡∏≠‡∏á Google Apps Script Web App
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbydYOMVB3jO1QDIraP6IcII0s6V2YOzvrvxKP0X_hCi4u0UdEJkLnJt_yJeWsDzAB-0/exec'; // **‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL ‡∏ô‡∏µ‡πâ**

        // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
        let currentPage = 'home';
        let isAdminLoggedIn = false;
        let allAdminData = []; 
        let campData = [];
        let documentData = []; // NEW: ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
        let lendingData = []; // NEW: ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°‡∏Ç‡∏≠‡∏á
        let currentGradeFilter = 'all';
        const ADMIN_PASSWORD = 'admin1234'; 
        const DOCUMENT_EDIT_PASSWORD = 'admin1324';

        // =======================================================
        // #region 1. Helper & Utility Functions
        // =======================================================

        function showNotification(message, type = 'success') {
            const existingNotifications = document.querySelectorAll('.notification');
            existingNotifications.forEach(notification => {
                notification.classList.add('fade-out');
                setTimeout(() => notification.remove(), 300);
            });
            const notification = document.createElement('div');
            notification.className = `alert alert-${type} notification`;
            notification.innerHTML = message;
            document.body.appendChild(notification);
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.classList.add('fade-out');
                    setTimeout(() => notification.remove(), 300);
                }
            }, 5000);
        }

        async function checkConnection() {
            if (SCRIPT_URL.includes('AKfycbxDqZK4yR9Xw2X7_g4ZrY8ek0bXrxRpd0G_rzzLPjso-M5zsjo5ols7PaKqO_xHcKsM3A')) {
                showNotification(`
                    <strong>‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Apps Script ‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</strong><br>
                    1. ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà URL ‡πÉ‡∏ô JavaScript ‡∏î‡πâ‡∏ß‡∏¢ Script ID ‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πâ‡∏à‡∏£‡∏¥‡∏á<br>
                    2. Deploy Google Apps Script ‡πÄ‡∏õ‡πá‡∏ô Web App<br>
                    3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Permissions ‡πÉ‡∏´‡πâ Anyone can access
                `, 'warning');
                return false;
            }

            try {
                const response = await fetch(`${SCRIPT_URL}?action=test`, { method: 'GET' });
                const result = await response.json();
                return result.success;
            } catch (error) {
                console.error('Connection check failed:', error);
                return false;
            }
        }
        
        // =======================================================
        // #region 2. Navigation & Page Flow
        // =======================================================

        function showPage(pageId, event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            currentPage = pageId;
            
            if (pageId === 'admin' && isAdminLoggedIn) {
                loadAllData(); 
                loadCampData(true); 
                loadDocumentData(); 
                loadLendingData(true);
                showAdminData('behaviorData');
            }
            if (pageId === 'documentTracking') {
                showDocumentSubPage('addDocument');
            }
            if (pageId === 'lendingTracking') {
                showLendingSubPage('addLending');
            }
        }

        function showDocumentSubPage(subPageId) {
            document.querySelectorAll('#documentTracking .sub-page').forEach(page => page.classList.remove('active'));
            document.getElementById(subPageId).classList.add('active');
            document.querySelectorAll('#documentTracking .nav-btn').forEach(btn => btn.classList.remove('active'));
            if (event.target.classList && event.target.classList.contains('nav-btn')) event.target.classList.add('active');
            
            if (subPageId === 'viewDocument') {
                loadDocumentData();
            }
        }

        function showLendingSubPage(subPageId) {
            document.querySelectorAll('#lendingTracking .sub-page').forEach(page => page.classList.remove('active'));
            document.getElementById(subPageId).classList.add('active');
            document.querySelectorAll('#lendingTracking .nav-btn').forEach(btn => btn.classList.remove('active'));
            if (event.target.classList && event.target.classList.contains('nav-btn')) event.target.classList.add('active');
            
            if (subPageId === 'viewLending') {
                loadLendingData(false); 
            }
        }

        function showAdminReportMenu() {
            document.getElementById('adminReportMenu').style.display = 'block';
            document.getElementById('adminDataMenu').style.display = 'none';
            showAdminReport('behaviorReport', document.querySelector('#adminReportMenu .nav-btn:first-child'));
        }

        function showAdminReport(reportId, btn) {
            document.querySelectorAll('.report-content').forEach(div => div.classList.remove('active'));
            document.getElementById(reportId).classList.add('active');
            document.querySelectorAll('#adminReportMenu .nav-btn').forEach(b => b.classList.remove('active'));
            if (btn) btn.classList.add('active');

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
            if (reportId === 'behaviorReport') generateStats(allAdminData);
            if (reportId === 'campReport') generateCampStatsAdmin(campData);
            if (reportId === 'documentReport') generateDocStatsAdmin(documentData);
            if (reportId === 'lendingReport') generateLendStatsAdmin(lendingData);
        }

        function showAdminData(dataId, btn) {
            document.getElementById('adminReportMenu').style.display = 'none';
            document.getElementById('adminDataMenu').style.display = 'block';
            document.querySelectorAll('.data-content').forEach(div => div.classList.remove('active'));
            document.getElementById(dataId).classList.add('active');
            document.querySelectorAll('#adminDataMenu .nav-btn').forEach(b => b.classList.remove('active'));
            if (btn) btn.classList.add('active');
            
            if (dataId === 'campData') loadCampData(true); 
            if (dataId === 'behaviorData') loadAllData(); 
        }

        // =======================================================
        // #region 3. Behavior Management (‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏µ)
        // =======================================================

        document.getElementById('registerForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = e.target.querySelector('button[type="submit"]');
            const loading = document.getElementById('submitLoading');
            const submitText = document.getElementById('submitText');
            
            loading.style.display = 'inline-block';
            submitText.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';
            submitBtn.disabled = true;
            
            const isConnected = await checkConnection();
            if (!isConnected) {
                loading.style.display = 'none';
                submitText.textContent = '‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
                submitBtn.disabled = false;
                return;
            }
            
            const formData = {
                action: 'submit',
                studentId: document.getElementById('studentId').value.trim(),
                studentNo: document.getElementById('studentNo').value.trim(),
                fullName: document.getElementById('fullName').value.trim(),
                classroom: document.getElementById('classroom').value,
                behavior: document.getElementById('behavior').value.trim(),
                score: document.getElementById('score').value,
                teacherName: document.getElementById('teacherName').value.trim(),
                timestamp: new Date().toLocaleString('th-TH', {timeZone: 'Asia/Bangkok'}),
                status: '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£'
            };
            
            try {
                const params = new URLSearchParams();
                params.append('data', JSON.stringify(formData));
                
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: params
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showNotification('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!', 'success');
                    document.getElementById('registerForm').reset();
                    document.getElementById('behaviorCount').textContent = '500';
                } else {
                    showNotification(`‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${result.message}`, 'danger');
                }
            } catch (error) {
                showNotification('‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ', 'danger');
            }
            
            loading.style.display = 'none';
            submitText.textContent = '‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
            submitBtn.disabled = false;
        });

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£
        document.getElementById('behavior').addEventListener('input', function() {
            const maxLength = 500;
            const currentLength = this.value.length;
            const remaining = maxLength - currentLength;
            document.getElementById('behaviorCount').textContent = remaining;
            
            if (remaining < 50) {
                document.getElementById('behaviorCount').style.color = '#dc3545';
            } else {
                document.getElementById('behaviorCount').style.color = '#6c757d';
            }
        });

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
        async function searchStatus() {
            const studentId = document.getElementById('searchStudentId').value.trim();
            const loading = document.getElementById('searchLoading');
            const searchText = document.getElementById('searchText');
            const resultsDiv = document.getElementById('statusResults');
            
            if (!studentId) {
                showNotification('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', 'warning');
                return;
            }
            
            loading.style.display = 'inline-block';
            searchText.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...';
            resultsDiv.innerHTML = '';
            
            try {
                const response = await fetch(`${SCRIPT_URL}?action=search&studentId=${encodeURIComponent(studentId)}`);
                const result = await response.json();
                
                if (result.success && result.data && result.data.length > 0) {
                    let html = '<h3>üìã ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</h3>';
                    
                    result.data.forEach(record => {
                        const statusIcon = {
                            '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£': '‚è≥',
                            '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö': 'üîç',
                            '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥': '‚úÖ',
                            '‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥': '‚ùå'
                        };

                        const statusColor = {
                            '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£': '#ffdb58',
                            '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö': '#2196f3',
                            '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥': '#007769',
                            '‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥': '#dc3545'
                        }[record.status] || '#6c757d';

                        html += `
                            <div class="status-card">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <h4>üéØ ${record.fullName || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'} (${record.classroom || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'})</h4>
                                    <span style="color: white; background-color: ${statusColor}; padding: 4px 10px; border-radius: 15px; font-weight: bold;">
                                        ${statusIcon[record.status] || '‚ùì'} ${record.status || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}
                                    </span>
                                </div>
                                <p><strong>üéØ ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°:</strong> ${record.behavior || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}</p>
                                <p><strong>‚≠ê ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô:</strong> ${record.score || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</p>
                                <p><strong>üë®‚Äçüè´ ‡∏Ñ‡∏£‡∏π‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å:</strong> ${record.teacherName || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}</p>
                                <p><strong>üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å:</strong> ${record.timestamp || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}</p>
                                ${record.rejectReason ? `<p><strong>‚ùå ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥:</strong> <span style="color: #dc3545;">${record.rejectReason}</span></p>` : ''}
                                ${record.updatedBy && record.updatedAt ? `<p><strong>üîÑ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î:</strong> ${record.updatedBy} ‡πÄ‡∏°‡∏∑‡πà‡∏≠ ${record.updatedAt}</p>` : ''}
                            </div>
                        `;
                    });
                    
                    resultsDiv.innerHTML = html;
                } else {
                    resultsDiv.innerHTML = '<div class="alert alert-info">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ô‡∏µ‡πâ</div>';
                }
            } catch (error) {
                showNotification('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'danger');
                resultsDiv.innerHTML = '<div class="alert alert-danger">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Apps Script)</div>';
            }
            
            loading.style.display = 'none';
            searchText.textContent = 'üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤';
        }

        // =======================================================
        // #region 4. Admin Panel Logic (Login, Data Load, Display)
        // =======================================================

        async function adminLogin() {
            const password = document.getElementById('adminPassword').value;
            const messageDiv = document.getElementById('loginMessage');
            const loading = document.getElementById('loginLoading');
            const loginText = document.getElementById('loginText');
            
            loading.style.display = 'inline-block';
            loginText.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...';
            
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            if (password === ADMIN_PASSWORD) { 
                isAdminLoggedIn = true;
                document.getElementById('loginSection').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                document.getElementById('adminDataMenu').style.display = 'block';
                document.getElementById('adminReportMenu').style.display = 'none';
                messageDiv.innerHTML = '';
                showNotification('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                
                await loadAllData();
                await loadCampData(true); 
                await loadDocumentData();
                await loadLendingData(true);
                showAdminData('behaviorData', document.querySelector('#adminDataMenu .nav-btn:first-child'));
            } else {
                messageDiv.innerHTML = '<div class="alert alert-danger">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</div>';
            }
            
            loading.style.display = 'none';
            loginText.textContent = '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö';
        }

        function adminLogout() {
            isAdminLoggedIn = false;
            document.getElementById('loginSection').style.display = 'block';
            document.getElementById('adminPanel').style.display = 'none';
            document.getElementById('adminPassword').value = '';
            // Clear data displays
            document.getElementById('adminData').innerHTML = '';
            document.getElementById('adminStats').innerHTML = '';
            document.getElementById('campDataDisplay').innerHTML = '';
            allAdminData = [];
            campData = [];
            documentData = [];
            lendingData = [];
            showNotification('‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß', 'info');
        }
        
        function generateStats(data) {
            const stats = {
                total: data.length,
                pending: data.filter(r => r.status === '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£').length,
                approved: data.filter(r => r.status === '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥').length,
                rejected: data.filter(r => r.status === '‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥').length,
                reviewing: data.filter(r => r.status === '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö').length
            };

            const statsHtml = `
                <div class="stats-card">
                    <div class="stats-icon">üìä</div>
                    <div class="stats-number" style="color: #2c5f59;">${stats.total}</div>
                    <div class="stats-label">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                </div>
                <div class="stats-card">
                    <div class="stats-icon">‚è≥</div>
                    <div class="stats-number" style="color: #ffdb58;">${stats.pending}</div>
                    <div class="stats-label">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
                </div>
                <div class="stats-card">
                    <div class="stats-icon">üîç</div>
                    <div class="stats-number" style="color: #2196f3;">${stats.reviewing}</div>
                    <div class="stats-label">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</div>
                </div>
                <div class="stats-card">
                    <div class="stats-icon">‚úÖ</div>
                    <div class="stats-number" style="color: #007769;">${stats.approved}</div>
                    <div class="stats-label">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</div>
                </div>
                <div class="stats-card">
                    <div class="stats-icon">‚ùå</div>
                    <div class="stats-number" style="color: #dc3545;">${stats.rejected}</div>
                    <div class="stats-label">‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</div>
                </div>
            `;

            document.getElementById('adminStats').innerHTML = statsHtml;
        }

        // ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á (Behavior)
        function displayAdminData(data) {
            const dataDiv = document.getElementById('adminData');
            
            if (!data || data.length === 0) {
                dataDiv.innerHTML = '<div class="alert alert-info">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</div>';
                return;
            }

            let html = `
                <h3>üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏µ (${data.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)</h3>
                <div style="overflow-x: auto;">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>‡∏£‡∏´‡∏±‡∏™</th>
                                <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                                <th>‡∏´‡πâ‡∏≠‡∏á</th>
                                <th style="min-width: 200px;">‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°</th>
                                <th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th>
                                <th>‡∏Ñ‡∏£‡∏π‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</th>
                                <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                <th style="min-width: 120px;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th style="min-width: 250px;">‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            data.forEach((record) => {
                // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏µ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
                const statusColor = {
                    '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥': '#007769', // Primary Green
                    '‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥': '#dc3545', // Danger Red
                    '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö': '#2196f3', // Info Blue
                    '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£': '#ffdb58' // Accent Gold
                }[record.status] || '#6c757d';
                
                // rowIndex ‡∏Ñ‡∏∑‡∏≠ index ‡πÅ‡∏ñ‡∏ß‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô Google Sheet (‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà 2)
                const actualRowIndex = record.rowIndex;
                
                html += `
                    <tr id="row-${actualRowIndex}">
                        <td>${record.studentId || '-'}</td>
                        <td>${record.fullName || '-'}</td>
                        <td>${record.classroom || '-'}</td>
                        <td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis;" title="${record.behavior || ''}">
                            ${record.behavior ? record.behavior.substring(0, 50) + (record.behavior.length > 50 ? '...' : '') : '-'}
                        </td>
                        <td>${record.score || '-'}</td>
                        <td>${record.teacherName || '-'}</td>
                        <td style="font-size: 12px;">${record.timestamp || '-'}</td>
                        <td><span class="status-badge" style="background-color: ${statusColor}; color: white;">${record.status || '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£'}</span></td>
                        <td>
                            ${record.status === '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£' || record.status === '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö' ? `
                                <div class="action-buttons">
                                    <button class="btn btn-success" onclick="updateStatus(${actualRowIndex}, '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥')" data-row="${actualRowIndex}">‚úÖ ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</button>
                                    <button class="btn btn-danger" onclick="rejectRecord(${actualRowIndex})" data-row="${actualRowIndex}">‚ùå ‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</button>
                                </div>
                            ` : `
                                <span style="color: #007769;">${record.status}</span>
                                ${record.rejectReason ? `<br><small style="color: #dc3545;">‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•: ${record.rejectReason}</small>` : ''}
                                ${record.updatedBy ? `<br><small style="color: #6c757d;">‡πÇ‡∏î‡∏¢: ${record.updatedBy}</small>` : ''}
                            `}
                        </td>
                    </tr>
                `;
            });
            
            html += '</tbody></table></div>';
            dataDiv.innerHTML = html;
        }

        async function loadAllData() {
            const loading = document.getElementById('loadLoading');
            const loadText = document.getElementById('loadText');
            const dataDiv = document.getElementById('adminData');
            
            loading.style.display = 'inline-block';
            loadText.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...';
            
            try {
                const response = await fetch(`${SCRIPT_URL}?action=getAll`);
                const result = await response.json();
                
                if (result.success && result.data && result.data.length > 0) {
                    allAdminData = result.data;
                    generateStats(result.data); 
                    displayAdminData(result.data); 
                    
                    showNotification('‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'success');
                } else {
                    allAdminData = [];
                    dataDiv.innerHTML = '<div class="alert alert-info">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</div>';
                    document.getElementById('adminStats').innerHTML = '';
                }
            } catch (error) {
                showNotification('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°', 'danger');
                dataDiv.innerHTML = '<div class="alert alert-danger">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå</div>';
            }
            
            loading.style.display = 'none';
            loadText.textContent = 'üìã ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î';
        }
        
        function filterByStatus() {
            const selectedStatus = document.getElementById('statusFilter').value;
            
            if (!selectedStatus) {
                displayAdminData(allAdminData);
            } else {
                const filteredData = allAdminData.filter(record => record.status === selectedStatus);
                displayAdminData(filteredData);
            }
        }

        async function updateStatus(rowIndex, newStatus, rejectReason = '') {
            try {
                const buttons = document.querySelectorAll(`button[data-row="${rowIndex}"]`);
                buttons.forEach(btn => {
                    btn.disabled = true;
                    btn.innerHTML = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£...';
                });
                
                const updateData = {
                    action: 'updateStatus',
                    rowIndex: rowIndex,
                    status: newStatus,
                    rejectReason: rejectReason,
                    updatedBy: '‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö',
                    updatedAt: new Date().toLocaleString('th-TH')
                };
                
                const params = new URLSearchParams();
                params.append('data', JSON.stringify(updateData));
                
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: params
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showNotification(`‚úÖ ${newStatus === '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥' ? '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥' : '‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥'}‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß`, 'success');
                    await loadAllData();
                } else {
                    showNotification('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ' + result.message, 'danger');
                    buttons.forEach(btn => {
                        btn.disabled = false;
                        btn.innerHTML = btn.innerHTML.includes('‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥') ? '‚úÖ ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥' : '‚ùå ‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥';
                    });
                }
            } catch (error) {
                showNotification('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠: ' + error.message, 'danger');
                const buttons = document.querySelectorAll(`button[data-row="${rowIndex}"]`);
                buttons.forEach(btn => {
                    btn.disabled = false;
                    btn.innerHTML = btn.innerHTML.includes('‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥') ? '‚úÖ ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥' : '‚ùå ‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥';
                });
            }
        }

        function rejectRecord(rowIndex) {
            const reason = prompt('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥:');
            if (reason && reason.trim()) {
                updateStatus(rowIndex, '‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥', reason.trim());
            } else if (reason === '') {
                showNotification('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥', 'warning');
            }
        }
        
        // =======================================================
        // #region 5. Camp Management Logic (‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢)
        // =======================================================
        
        function generateCampStatsAdmin(data) {
            const stats = {
                total: data.length,
                camp: data.filter(r => r.status === '‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢').length,
                volunteer: data.filter(r => r.status === '‡∏à‡∏¥‡∏ï‡∏≠‡∏≤‡∏™‡∏≤').length,
                completed: data.filter(r => r.follow === '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß').length,
                waiting: data.filter(r => r.follow === '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£').length
            };

            const statsHtml = `
                <div class="stats-card">
                    <div class="stats-icon">üë•</div>
                    <div class="stats-number" style="color: #2c5f59;">${stats.total}</div>
                    <div class="stats-label">‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                </div>
                <div class="stats-card">
                    <div class="stats-icon">üèïÔ∏è</div>
                    <div class="stats-number" style="color: #dc3545;">${stats.camp}</div>
                    <div class="stats-label">‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢</div>
                </div>
                <div class="stats-card">
                    <div class="stats-icon">ü§ù</div>
                    <div class="stats-number" style="color: #007769;">${stats.volunteer}</div>
                    <div class="stats-label">‡∏à‡∏¥‡∏ï‡∏≠‡∏≤‡∏™‡∏≤</div>
                </div>
                <div class="stats-card">
                    <div class="stats-icon">‚úÖ</div>
                    <div class="stats-number" style="color: #007769;">${stats.completed}</div>
                    <div class="stats-label">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß</div>
                </div>
                <div class="stats-card">
                    <div class="stats-icon">‚è≥</div>
                    <div class="stats-number" style="color: #ffdb58;">${stats.waiting}</div>
                    <div class="stats-label">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
                </div>
            `;
            document.getElementById('adminCampStats').innerHTML = statsHtml;
        }

        async function loadCampData(isAdmin = false) {
            try {
                const response = await fetch(`${SCRIPT_URL}?action=getCampData`);
                const result = await response.json();
                
                if (result.success) {
                    campData = result.data || [];
                    generateCampStatsAdmin(campData); 
                    filterCampData(); 
                } else {
                    showNotification('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏¢: ' + result.message, 'danger');
                    document.getElementById('campDataDisplay').innerHTML = '<div class="alert alert-danger">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏¢</div>';
                }
            } catch (error) {
                showNotification('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏¢', 'danger');
                document.getElementById('campDataDisplay').innerHTML = '<div class="alert alert-danger">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå</div>';
            }
        }
        
        // ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢‡∏à‡∏£‡∏¥‡∏á
   function displayCampData(data) {
            const dataDiv = document.getElementById('campDataDisplay');
            
            if (!data || data.length === 0) {
                dataDiv.innerHTML = '<div class="alert alert-info">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢‡∏ï‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á</div>';
                return;
            }
            
            let html = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="margin: 0;">üìã ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢ (${data.length} ‡∏Ñ‡∏ô)</h3>
                    <span style="background: #007769; color: white; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600;">üîì ‡πÇ‡∏´‡∏°‡∏î Admin</span>
                </div>
                
                <div style="overflow-x: auto;">
                    <table class="table">
                        <thead>
                            <tr>
                                <th style="width: 60px;">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                                <th>‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß</th>
                                <th>‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                                <th>‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>
                                <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</th>
                                <th style="min-width: 200px;">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                                <th style="width: 120px;">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            data.forEach((record, index) => {
                // *** ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ***
                const studentId = record.studentId || '-';
                const fullName = record.fullName || '-';
                const classroom = record.classroom || '-';
                const status = record.status || '-';
                const follow = record.follow || '-';
                const note = record.note || '';

                const statusClass = `status-${status.replace(/\s/g, '')}`;
                const followClass = `follow-${follow.replace(/\s/g, '')}`;
                
                // rowIndex ‡∏Ñ‡∏∑‡∏≠ index ‡πÅ‡∏ñ‡∏ß‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô Google Sheet (‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏° Edit/Delete)
                const actualRowIndex = record.rowIndex || index + 2; 

                html += `
                    <tr>
                        <td style="text-align: center; font-weight: bold; color: #2c5f59;">${index + 1}</td>
                        <td style="font-family: monospace; font-weight: 600;">${studentId}</td>
                        <td style="font-weight: 500;">${fullName}</td>
                        <td>
                            <span style="background: rgba(0, 119, 105, 0.1); color: #007769; padding: 2px 8px; border-radius: 12px; font-size: 13px; font-weight: 600;">
                                ${classroom}
                            </span>
                        </td>
                        <td>
                            <span class="status-badge ${statusClass}">
                                ${status}
                            </span>
                        </td>
                        <td>
                            <span class="status-badge ${followClass}">
                                ${follow}
                            </span>
                        </td>
                        <td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis;" title="${note}">
                            ${note ? 
                                `<span style="color: #495057;">${note.substring(0, 50)}...</span>` : 
                                '<span style="color: #adb5bd; font-style: italic;">-</span>'
                            }
                        </td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-warning" 
                                        onclick="editCampStudent(${actualRowIndex})" 
                                        style="padding: 6px 12px; font-size: 12px; border-radius: 15px;"
                                        title="‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•">
                                    ‚úèÔ∏è
                                </button>
                                <button class="btn btn-danger" 
                                        onclick="deleteCampStudent(${actualRowIndex})" 
                                        style="padding: 6px 12px; font-size: 12px; border-radius: 15px;"
                                        title="‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•">
                                    üóëÔ∏è
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            });
            
            html += `
                        </tbody>
                    </table>
                </div>
                <div style="background: rgba(0, 119, 105, 0.1); border-radius: 10px; padding: 15px; margin-top: 20px; text-align: center;">
                    <p style="margin: 0; color: #007769; font-size: 14px;">
                        ‚úÖ <strong>‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö</strong> ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡πÄ‡∏û‡∏¥‡πà‡∏° ‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
                    </p>
                </div>
            `;
            
            dataDiv.innerHTML = html;
        }
        
        function filterCampData() {
            const statusFilter = document.getElementById('campStatusFilter').value;
            const followFilter = document.getElementById('campFollowFilter').value;
            
            let filteredData = campData;
            
            // ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
            if (statusFilter) {
                filteredData = filteredData.filter(record => record.status === statusFilter);
            }
            
            // ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°
            if (followFilter) {
                filteredData = filteredData.filter(record => record.follow === followFilter);
            }
            
            // ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
            if (currentGradeFilter !== 'all') {
                filteredData = filteredData.filter(record => {
                    if (record.classroom) {
                        const gradeMatch = record.classroom.match(/^‡∏°\.?(\d)/);
                        return gradeMatch && gradeMatch[1] === currentGradeFilter;
                    }
                    return false;
                });
            }

            displayCampData(filteredData);
        }

        // Placeholder functions for Camp Management
        function addCampStudent() { document.getElementById('campModal').style.display = 'flex'; }
        function editCampStudent(rowIndex) { showNotification('‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢ (‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏ï‡πá‡∏°)', 'warning'); }
        function deleteCampStudent(rowIndex) { if(confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢ (Row: ' + rowIndex + ') ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) { showNotification('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢ (‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏ï‡πá‡∏°)', 'info'); loadCampData(true); } }
        function exportCampData() { showNotification('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏¢ (‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏ï‡πá‡∏°)', 'info'); }


        // =======================================================
        // #region 6. Document & Lending Logic
        // =======================================================

        async function loadDocumentData() {
            // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å Apps Script
            try {
                const response = await fetch(`${SCRIPT_URL}?action=getDocumentData`);
                const result = await response.json();
                
                if (result.success) {
                    documentData = result.data || [];
                    generateDocStatsAdmin(documentData);
                    filterDocumentData(); // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏Å‡∏£‡∏≠‡∏á
                } else {
                    document.getElementById('documentDataDisplay').innerHTML = '<div class="alert alert-danger">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</div>';
                }
            } catch(e) {
                document.getElementById('documentDataDisplay').innerHTML = '<div class="alert alert-danger">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</div>';
            }
        }
        
        function generateDocStatsAdmin(data) {
             document.getElementById('adminDocStats').innerHTML = '<div class="alert alert-info">Dummy Stats: Document (Total: '+data.length+')</div>';
        }

        // ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏à‡∏£‡∏¥‡∏á
        function displayDocumentData(data) {
            const dataDiv = document.getElementById('documentDataDisplay');
            if (!data || data.length === 0) {
                dataDiv.innerHTML = '<div class="alert alert-info">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á</div>';
                return;
            }

            const signatures = [
                'sig1: ‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á', 'sig2: ‡∏Ñ‡∏£‡∏π‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤', 'sig3: ‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô', 'sig4: ‡∏á‡∏≤‡∏ô‡∏ß‡∏±‡∏î‡∏ú‡∏•‡∏Ø', 
                'sig5: ‡∏Å‡∏≤‡∏£‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô', 'sig6: ‡∏£‡∏≠‡∏á‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£', 'sig7: ‡∏£‡∏≠‡∏á‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•', 'sig8: ‡∏ú‡∏π‡πâ‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£'
            ];
            
            let html = `
                <h3>üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (${data.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)</h3>
                <div style="overflow-x: auto;">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>‡∏£‡∏´‡∏±‡∏™/‡∏ä‡∏∑‡πà‡∏≠</th>
                                <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                                <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏´‡∏•‡∏±‡∏Å</th>
                                <th style="min-width: 150px;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á</th>
                                <th style="min-width: 350px;">‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô</th>
                                <th>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody>
            `;

            data.forEach(record => {
                let signatureBadges = '';
                signatures.forEach((sigLabel, index) => {
                    const field = `sig${index + 1}`;
                    const status = record[field] || 'Pending';
                    const badgeClass = status === 'Complete' ? 'signature-complete' : (status === 'Not Required' ? 'signature-not-required' : 'signature-pending');
                    const badgeIcon = status === 'Complete' ? '‚úÖ' : (status === 'Not Required' ? '‚ûñ' : '‚è≥');
                    
                    signatureBadges += `<span class="signature-badge ${badgeClass}" title="${sigLabel}">
                        ${badgeIcon} ${sigLabel.split(': ')[1]}
                    </span>`;
                });

                const statusClass = `status-${(record.status || '').replace(/\s/g, '')}`;
                
                html += `
                    <tr>
                        <td>${record.studentId || '-'} / ${record.fullName || '-'}</td>
                        <td>${record.docType || '-'}</td>
                        <td><span class="status-badge ${statusClass}">${record.status || '-'}</span></td>
                        <td>${record.sentDate || '-'}</td>
                        <td><div style="display:flex; flex-wrap: wrap;">${signatureBadges}</div></td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-warning" 
                                        onclick="editDocument(${record.rowIndex})" 
                                        style="padding: 6px 12px; font-size: 12px; border-radius: 15px;"
                                        title="‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô">
                                    ‚úèÔ∏è
                                </button>
                                <button class="btn btn-danger" 
                                        onclick="deleteDocument(${record.rowIndex})" 
                                        style="padding: 6px 12px; font-size: 12px; border-radius: 15px;"
                                        title="‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•">
                                    üóëÔ∏è
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            });
            
            html += `</tbody></table></div>`;
            dataDiv.innerHTML = html;
        }
        
        function filterDocumentData() {
             // (‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ - ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏ï‡πá‡∏°)
             loadDocumentData(); 
        }

        // Placeholder functions for Document Management
        function editDocument(rowIndex) { showNotification('‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏ï‡πá‡∏°)', 'warning'); }
        function deleteDocument(rowIndex) { if(confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (Row: ' + rowIndex + ') ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) { showNotification('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏ï‡πá‡∏°)', 'info'); loadDocumentData(); } }
        function closeDocEditModal() { document.getElementById('docEditModal').style.display = 'none'; }


        async function loadLendingData(isReturned = false) {
             try {
                const response = await fetch(`${SCRIPT_URL}?action=getLendingData&isReturned=${isReturned}`);
                const result = await response.json();
                
                if (result.success) {
                    lendingData = result.data || [];
                    generateLendStatsAdmin(lendingData);
                    displayLendingData(lendingData, isReturned);
                } else {
                    document.getElementById('lendingDataDisplay').innerHTML = '<div class="alert alert-danger">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°</div>';
                }
            } catch(e) {
                document.getElementById('lendingDataDisplay').innerHTML = '<div class="alert alert-danger">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°</div>';
            }
        }
        
        function generateLendStatsAdmin(data) {
             document.getElementById('adminLendStats').innerHTML = '<div class="alert alert-info">Dummy Stats: Lending (Total: '+data.length+')</div>';
        }

        // ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°‡∏Ç‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á
        function displayLendingData(data, isReturned) {
            const dataDiv = document.getElementById('lendingDataDisplay');
            const title = isReturned ? 'üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß' : 'üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏∑‡∏ô';
            
            if (!data || data.length === 0) {
                dataDiv.innerHTML = `<div class="alert alert-info">‡πÑ‡∏°‡πà‡∏û‡∏ö ${title}</div>`;
                return;
            }
            
            let html = `
                <h3>${title} (${data.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)</h3>
                <div style="overflow-x: auto;">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>‡∏£‡∏´‡∏±‡∏™/‡∏´‡πâ‡∏≠‡∏á</th>
                                <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏¢‡∏∑‡∏°</th>
                                <th>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</th>
                                <th style="min-width: 250px;">‡∏™‡∏¥‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡∏°</th>
                                <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡∏°</th>
                                <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏∑‡∏ô</th>
                                <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            data.forEach(record => {
                const status = record.isReturned === 'Yes' ? '‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß' : '‡∏¢‡∏∑‡∏°‡∏≠‡∏¢‡∏π‡πà';
                const statusClass = record.isReturned === 'Yes' ? 'status-‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß' : 'status-‡∏¢‡∏∑‡∏°‡∏≠‡∏¢‡∏π‡πà';
                
                html += `<tr>
                    <td>${record.studentId || '-'} / ${record.classroom || '-'}</td>
                    <td>${record.fullName || '-'}</td>
                    <td>${record.tel || '-'}</td>
                    <td title="${record.item || '-'}">${record.item ? record.item.substring(0, 50) + '...' : '-'}</td>
                    <td>${record.lendDate || '-'}</td>
                    <td>${record.returnDate || '-'}</td>
                    <td><span class="status-badge ${statusClass}">${status}</span></td>
                    <td>
                        ${record.isReturned !== 'Yes' ? 
                            `<button class="btn btn-success" onclick="markAsReturned(${record.rowIndex})" style="padding: 6px 12px; font-size: 12px; border-radius: 15px;">
                                ‚úÖ ‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß
                            </button>` : 
                            `<span style="color: #007769;">‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠: ${record.returnedAt || '-'}</span>`}
                    </td>
                </tr>`;
            });
            
            html += `</tbody></table></div>`;
            dataDiv.innerHTML = html;
        }

        // Placeholder function for Lending Management
        async function markAsReturned(rowIndex) {
            const password = prompt(`‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô Admin (${ADMIN_PASSWORD}) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô‡∏Ç‡∏≠‡∏á:`);
            if (password !== ADMIN_PASSWORD) {
                showNotification('‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡∏Å‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å', 'danger');
                return;
            }
            showNotification('‚úÖ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô‡∏Ç‡∏≠‡∏á (‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏ï‡πá‡∏°)', 'success');
            // Logic to call Apps Script to update status
            loadLendingData(false); // Reload the 'not returned' list
        }


        // =======================================================
        // #region 7. Export All Data
        // =======================================================

        async function exportAllData() {
            showNotification('‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å 4 ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å... ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà', 'info');
             try {
                const response = await fetch(`${SCRIPT_URL}?action=exportAllData`);
                const result = await response.json();
                
                if (result.success && result.csvContent) {
                    const csvContent = result.csvContent;
                    const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
                    const link = document.createElement('a');
                    const url = URL.createObjectURL(blob);
                    link.setAttribute('href', url);
                    link.setAttribute('download', `all_data_${new Date().toISOString().slice(0, 10)}.csv`);
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    showNotification('‚úÖ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏ß‡∏° 4 ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß', 'success');
                } else {
                    showNotification(`‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å: ${result.message || '‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• CSV'}`, 'danger');
                }
            } catch (error) {
                showNotification('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'danger');
            }
        }


        // =======================================================
        // #region 8. Initialization
        // =======================================================
        window.addEventListener('load', function() {
            checkConnection();
            showPage('home');
        });
        
        // Event Listeners for Enter key (Behavior, Admin Login)
        document.getElementById('searchStudentId').addEventListener('keypress', function(e) { if (e.key === 'Enter') searchStatus(); });
        document.getElementById('adminPassword').addEventListener('keypress', function(e) { if (e.key === 'Enter') adminLogin(); });
        document.addEventListener('click', function(e) { if (e.target.id === 'campModal' || e.target.id === 'docEditModal') { closeCampModal(); closeDocEditModal(); } });

    </script>

</body>
</html>





