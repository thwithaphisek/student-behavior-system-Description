function displayDashboard(data) {
            [cite_start]const stats = data.stats; [cite: 118]
            const statsContainer = document.getElementById('dashboardStats');
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°
            statsContainer.innerHTML = `
                <div class="stats-card">
                    <div class="stats-icon" style="color:#2e7d32;">üèÉ</div>
                    <div class="stats-number">${stats.lateCount}</div>
                    <div class="stats-label">‡∏°‡∏≤‡∏™‡∏≤‡∏¢ (‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å)</div>
                </div>
                <div class="stats-card">
                    <div class="stats-icon" style="color:#ffc107;">üì¶</div>
                    <div class="stats-number">${stats.lendingCount}</div>
                    <div class="stats-label">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°‡∏Ñ‡πâ‡∏≤‡∏á (‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)</div>
                </div>
                <div class="stats-card">
                    <div class="stats-icon" style="color:#17a2b8;">üìë</div>
                    <div class="stats-number">${stats.docCount}</div>
                    <div class="stats-label">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏£‡∏≠‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</div>
                </div>
                <div class="stats-card">
                    <div class="stats-icon" style="color:#dc3545;">üö´</div>
                    <div class="stats-number">${stats.blacklistCount}</div>
                    <div class="stats-label">‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°</div>
                </div>
            [cite_start]`; [cite: 118-119]

            // ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏°‡∏≤‡∏™‡∏≤‡∏¢‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏´‡πâ‡∏≠‡∏á
            const lateDetail = document.getElementById('dashboardLateDetail');
            let lateHtml = '<h4>üèÉ ‡∏™‡∏£‡∏∏‡∏õ‡∏°‡∏≤‡∏™‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏´‡πâ‡∏≠‡∏á</h4>';
            if (data.details.lateSummary && data.details.lateSummary.length > 0) {
                lateHtml += '<table class="table"><thead><tr><th>‡∏´‡πâ‡∏≠‡∏á</th><th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡∏Ñ‡∏£‡∏±‡πâ‡∏á)</th></tr></thead><tbody>';
                data.details.lateSummary.forEach(item => {
                    lateHtml += `<tr><td>${item.classroom}</td><td>${item.count}</td></tr>`;
                });
                lateHtml += '</tbody></table>';
            } else {
                lateHtml += '<p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡∏™‡∏≤‡∏¢</p>';
            }
            [cite_start]lateDetail.innerHTML = lateHtml; [cite: 114-115, 119]
        }

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢ (Admin Camp) ---
        function displayAdminCampData(data) {
            const container = document.getElementById('adminCampData');
            let html = '<table class="table"><thead><tr><th>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th><th>‡∏´‡πâ‡∏≠‡∏á</th><th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th><th>‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</th></tr></thead><tbody>';
            data.reverse().forEach(row => {
                html += `<tr>
                    <td>${row.fullName}</td>
                    <td>${row.classroom}</td>
                    <td><span class="status-badge status-${row.status}">${row.status}</span></td>
                    <td>
                        <button onclick="editCampStudent(${row.rowIndex})" class="btn btn-warning" style="padding:5px 10px;">‚úèÔ∏è</button>
                        <button onclick="deleteCampStudent(${row.rowIndex})" class="btn btn-danger" style="padding:5px 10px;">üóëÔ∏è</button>
                    </td>
                </tr>`;
            });
            html += '</tbody></table>';
            [cite_start]container.innerHTML = html; [cite: 51-52, 64]
        }

        function openCampModal(rowIndex = null) {
            const modal = document.getElementById('campModal');
            const form = document.getElementById('campForm');
            form.reset();
            if (rowIndex) {
                const record = campData.find(d => d.rowIndex == rowIndex);
                document.getElementById('campRowIndex').value = record.rowIndex;
                document.getElementById('campStudentId').value = record.studentId;
                document.getElementById('campFullName').value = record.fullName;
                document.getElementById('campClassroom').value = record.classroom;
                document.getElementById('campStatus').value = record.status;
                document.getElementById('campFollow').value = record.follow;
                document.getElementById('campNote').value = record.note;
            } else {
                document.getElementById('campRowIndex').value = '';
            }
            modal.style.display = 'flex';
        }

        document.getElementById('campForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const formData = {
                action: document.getElementById('campRowIndex').value ? 'updateCampStudent' : 'addCampStudent',
                rowIndex: document.getElementById('campRowIndex').value,
                studentId: document.getElementById('campStudentId').value,
                fullName: document.getElementById('campFullName').value,
                classroom: document.getElementById('campClassroom').value,
                status: document.getElementById('campStatus').value,
                follow: document.getElementById('campFollow').value,
                note: document.getElementById('campNote').value
            };
            [cite_start]const result = await postToGoogleScript(formData); [cite: 23-24, 53-61]
            if (result.success) { showNotification('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'); closeModal('campModal'); loadCampData(true); }
        });

        async function deleteCampStudent(rowIndex) {
            if (!confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ?')) return;
            [cite_start]const result = await postToGoogleScript({ action: 'deleteCampStudent', rowIndex: rowIndex }); [cite: 25, 62-63]
            if (result.success) { showNotification('‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'); loadCampData(true); }
        }

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°‡∏Ç‡∏≠‡∏á (Admin Lending) ---
        async function updateLendingStatus(rowIndex, status) {
            [cite_start]const result = await postToGoogleScript({ action: 'updateLendingStatus', rowIndex: rowIndex, status: status }); [cite: 30, 78-81]
            if (result.success) { showNotification('‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'); loadLendingData(true); }
        }

        function displayAdminLendingData(data) {
            const container = document.getElementById('adminLendingData');
            let html = '<table class="table"><thead><tr><th>‡∏ä‡∏∑‡πà‡∏≠</th><th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th><th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th><th>‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</th></tr></thead><tbody>';
            data.reverse().forEach(row => {
                html += `<tr>
                    <td>${row.fullName}</td>
                    <td>${row.item}</td>
                    <td>${row.status}</td>
                    <td>
                        ${row.status === '‡∏¢‡∏∑‡∏°' ? `<button onclick="updateLendingStatus(${row.rowIndex}, '‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß')" class="btn btn-success" style="padding:5px 10px;">‚úÖ ‡∏Ñ‡∏∑‡∏ô</button>` : ''}
                        <button onclick="deleteLendingItem(${row.rowIndex})" class="btn btn-danger" style="padding:5px 10px;">üóëÔ∏è</button>
                    </td>
                </tr>`;
            });
            html += '</tbody></table>';
            [cite_start]container.innerHTML = html; [cite: 51-52, 64]
        }

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏°‡∏≤‡∏™‡∏≤‡∏¢ (Admin Late) ---
        async function clearLateData() {
            if (!confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡∏™‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) return;
            [cite_start]const result = await postToGoogleScript({ action: 'clearLateData' }); [cite: 28, 82]
            if (result.success) { showNotification('‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'); loadLateData(true); }
        }

        // --- ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (Config) ---
        async function loadDocTypes() {
            [cite_start]const res = await fetch(`${SCRIPT_URL}?action=getDocTypes`); [cite: 13, 83]
            const result = await res.json();
            if (result.success) {
                docTypes = result.data;
                const container = document.getElementById('docTypesContainer');
                container.innerHTML = docTypes.map(t => `<div style="display:flex; justify-content:space-between; margin-bottom:5px; padding:8px; background:#f9f9f9; border-radius:5px;"><span>${t}</span><button onclick="deleteDocType('${t}')" class="btn btn-danger" style="padding:2px 8px; font-size:12px;">‡∏•‡∏ö</button></div>`).join('');
                
                // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Dropdown ‡πÉ‡∏ô Modal ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
                const select = document.getElementById('docType');
                [cite_start]select.innerHTML = docTypes.map(t => `<option value="${t}">${t}</option>`).join(''); [cite: 83-85]
            }
        }

        async function addDocType() {
            const type = document.getElementById('newDocType').value.trim();
            if (!type) return;
            [cite_start]const result = await postToGoogleScript({ action: 'addDocType', docType: type }); [cite: 40, 86-87]
            if (result.success) { showNotification('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'); document.getElementById('newDocType').value = ''; loadDocTypes(); }
        }

        async function deleteDocType(type) {
            if (!confirm(`‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ "${type}"?`)) return;
            [cite_start]const result = await postToGoogleScript({ action: 'deleteDocType', docType: type }); [cite: 41, 88-90]
            if (result.success) { showNotification('‡∏•‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'); loadDocTypes(); }
        }

        // --- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏î‡∏™‡∏≠‡∏ö (Test Data) ---
        async function testData(type) {
            [cite_start]const result = await postToGoogleScript({ action: 'addTestData', type: type }); [cite: 42, 91-98]
            if (result.success) { showNotification(`‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏î‡∏™‡∏≠‡∏ö ${type} ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à`); loadDataForAdminPage(currentAdminPage); }
        }

        // --- Helper: ‡∏õ‡∏¥‡∏î Modal ‡πÅ‡∏•‡∏∞ Export CSV ---
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }
        
        function exportCampData() {
            if (campData.length === 0) return;
            const headers = ['Student ID', 'Full Name', 'Classroom', 'Status', 'Follow'];
            const rows = campData.map(d => [d.studentId, d.fullName, d.classroom, d.status, d.follow]);
            let csvContent = "data:text/csv;charset=utf-8,\ufeff" + headers.join(",") + "\n" + rows.map(e => e.join(",")).join("\n");
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "camp_data.csv");
            document.body.appendChild(link);
            link.click();
        }

        // --- ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏£‡πá‡∏à ---
        document.addEventListener('DOMContentLoaded', () => {
            initSignaturePad();
            showPage('home');
            
            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á Dashboard ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('dashStartDate').value = today;
            document.getElementById('dashEndDate').value = today;
        });

        // ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö Modal ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ô‡∏≠‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà
        window.onclick = function(event) {
            if (event.target.className === 'modal') {
                event.target.style.display = 'none';
            }
        }
    </script>
</body>
</html>
